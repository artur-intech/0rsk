%link{href: 'https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.css', rel: 'stylesheet'}
%script{src: 'https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.js'}
%script{src: '/js/triple.js'}

%h2
  - if defined?(triple)
    Edit
    = "##{triple[:id]}"
  - else
    Add to the project
    = "##{project}"

%form{method: 'POST', action: iri.cut('/triple/save')}
  %fieldset
    %label
      Cause:
      %a.small.item{id: 'ctext_detach', href: '#', style: defined?(triple) ? '' : 'display: none;'} Detach
    %input{id: 'ctext', type: 'text', name: 'ctext', size: 40, autocomplete: 'off', autofocus: 'true', tabindex: 1, value: defined?(triple) ? triple[:ctext] : ''}
    %input{id: 'cid', type: 'text', name: 'cid', size: 3, autocomplete: 'off', readonly: true, value: defined?(triple) ? triple[:cid] : ''}
    %label
      Risk:
      %a.small.item{id: 'rtext_detach', href: '#', style: defined?(triple) ? '' : 'display: none;'} Detach
    %input{id: 'rtext', type: 'text', name: 'rtext', size: 50, maxlength: 160, tabindex: 2, value: defined?(triple) ? triple[:rtext] : ''}
    %input{id: 'rid', type: 'text', name: 'rid', size: 3, autocomplete: 'off', readonly: true, value: defined?(triple) ? triple[:rid] : ''}
    %label
      Probability:
    %select{id: 'probability', name: 'probability', tabindex: 3}
      - {'Definitely' => 9, 'Extremely high' => 8, 'High' => 6, 'Average' => 5, 'Low' => 4, 'Very low' => 2, 'Unlikely' => 1}.each do |k, v|
        %option{value: v, selected: defined?(triple) && triple[:probability] == v || v == 5}= "#{k} (#{v})"
    %label
      Effect:
      %a.small.item{id: 'etext_detach', href: '#', style: defined?(triple) ? '' : 'display: none;'} Detach
    %input{id: 'etext', type: 'text', name: 'etext', size: 60, maxlength: 160, autocomplete: 'off', tabindex: 4, value: defined?(triple) ? triple[:etext] : ''}
    %input{id: 'eid', type: 'text', name: 'eid', size: 3, autocomplete: 'off', readonly: true, value: defined?(triple) ? triple[:eid] : ''}
    %label
      Consequences are positive?
    %input{id: 'positive', type: 'checkbox', name: 'positive', tabindex: 5, value: 'positive', checked: defined?(triple) && triple[:positive] ? 'true' : nil}
    %label
      Impact:
    %select{id: 'impact', name: 'impact', tabindex: 6}
      - {'Fatal' => 9, 'Catastrophic' => 8, 'Serious' => 6, 'Average' => 5, 'Moderate' => 4, 'Minor' => 2, 'Unnoticable' => 1}.each do |k, v|
        %option{value: v, selected: defined?(triple) && triple[:impact] == v || v == 5, type: 'negative', hidden: defined?(triple) && triple[:positive]}= "#{k} (#{v})"
      - {'Fantastic' => 9, 'Awesome' => 8, 'Very good' => 6, 'Average' => 5, 'Good to have' => 4, 'Minor' => 2, 'Unnoticable' => 1}.each do |k, v|
        %option{value: v, selected: defined?(triple) && triple[:impact] == v, type: 'positive', hidden: !defined?(triple) || !triple[:positive]}= "#{k} (#{v})"
    %input{type: 'submit', value: 'Submit', tabindex: 7}
